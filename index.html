<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sistema de Control de Asistencias - Registro profesional de asistencias en campo">
    <meta name="theme-color" content="#667eea">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="assets/images/favicon.png">
    
    <!-- Título -->
    <title>Control de Asistencias | Tu Empresa</title>
    
    <!-- Preconexión para optimización -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Fuentes -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Estilos -->
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/responsive.css">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- iOS PWA -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link rel="apple-touch-icon" href="assets/images/icon-192.png">
</head>
<body>
    <!-- Loader -->
    <div id="pageLoader" class="page-loader">
        <div class="loader-spinner"></div>
    </div>

    <!-- Container Principal -->
    <div class="container" id="mainContainer">
        <!-- Header -->
        <header class="header">
            <div class="logo-container">
                <img src="logo/assistlogo.svg" alt="Logo" class="logo" id="companyLogo">
            </div>
            <h1 class="title">Control de Asistencias</h1>
            <p class="subtitle">Complete el formulario para registrar su asistencia</p>
        </header>

        <!-- Formulario -->
        <form id="attendanceForm" class="attendance-form" novalidate>
            <!-- Información Personal -->
            <section class="form-section">
                <h2 class="section-title">Información Personal</h2>
                
                <div class="form-group">
                    <label for="fullName" class="form-label">
                        Nombre Completo <span class="required">*</span>
                    </label>
                    <input 
                        type="text" 
                        id="fullName" 
                        name="fullName" 
                        class="form-input"
                        required
                        autocomplete="name"
                        placeholder="Ingrese su nombre completo"
                        maxlength="100"
                    >
                    <span class="error-message" id="fullNameError"></span>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="client" class="form-label">
                            Cliente <span class="required">*</span>
                        </label>
                        <select id="client" name="client" class="form-select" required>
                            <option value="">Seleccione un cliente</option>
                            <!-- Options se cargarán dinámicamente -->
                        </select>
                        <span class="error-message" id="clientError"></span>
                    </div>

                    <div class="form-group">
                        <label for="storeNumber" class="form-label">
                            Número de Tienda <span class="required">*</span>
                        </label>
                        <input 
                            type="number" 
                            id="storeNumber" 
                            name="storeNumber" 
                            class="form-input"
                            required
                            min="1"
                            max="99999"
                            placeholder="Ej: 1234"
                        >
                        <span class="error-message" id="storeNumberError"></span>
                    </div>
                </div>
            </section>

            <!-- Evidencia Fotográfica -->
            <section class="form-section">
                <h2 class="section-title">
                    Evidencia Fotográfica
                    <span class="section-subtitle">3 fotos de asistencia + 1 foto del ticket</span>
                </h2>

                <!-- Fotos de Asistencia -->
                <div class="photo-grid" id="attendancePhotos">
                    <div class="photo-upload-container" data-photo-id="1">
                        <div class="photo-placeholder">
                            <svg class="camera-icon" viewBox="0 0 24 24">
                                <path d="M12 15.2A3.2 3.2 0 1 1 15.2 12 3.2 3.2 0 0 1 12 15.2zm0-4.8A1.6 1.6 0 1 0 13.6 12 1.6 1.6 0 0 0 12 10.4z"/>
                                <path d="M20 4h-3.17L15 2H9L7.17 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2zm0 14H4V6h4.05l1.83-2h4.24l1.83 2H20v12z"/>
                            </svg>
                            <span class="photo-label">Foto 1</span>
                            <span class="photo-hint">Toque para capturar</span>
                        </div>
                        <div class="photo-preview-container">
                            <img class="photo-preview" id="preview1" alt="Preview foto 1">
                            <button type="button" class="photo-remove" aria-label="Eliminar foto">×</button>
                            <div class="photo-timestamp" id="timestamp1"></div>
                        </div>
                    </div>

                    <div class="photo-upload-container" data-photo-id="2">
                        <div class="photo-placeholder">
                            <svg class="camera-icon" viewBox="0 0 24 24">
                                <path d="M12 15.2A3.2 3.2 0 1 1 15.2 12 3.2 3.2 0 0 1 12 15.2zm0-4.8A1.6 1.6 0 1 0 13.6 12 1.6 1.6 0 0 0 12 10.4z"/>
                                <path d="M20 4h-3.17L15 2H9L7.17 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2zm0 14H4V6h4.05l1.83-2h4.24l1.83 2H20v12z"/>
                            </svg>
                            <span class="photo-label">Foto 2</span>
                            <span class="photo-hint">Toque para capturar</span>
                        </div>
                        <div class="photo-preview-container">
                            <img class="photo-preview" id="preview2" alt="Preview foto 2">
                            <button type="button" class="photo-remove" aria-label="Eliminar foto">×</button>
                            <div class="photo-timestamp" id="timestamp2"></div>
                        </div>
                    </div>

                    <div class="photo-upload-container" data-photo-id="3">
                        <div class="photo-placeholder">
                            <svg class="camera-icon" viewBox="0 0 24 24">
                                <path d="M12 15.2A3.2 3.2 0 1 1 15.2 12 3.2 3.2 0 0 1 12 15.2zm0-4.8A1.6 1.6 0 1 0 13.6 12 1.6 1.6 0 0 0 12 10.4z"/>
                                <path d="M20 4h-3.17L15 2H9L7.17 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2zm0 14H4V6h4.05l1.83-2h4.24l1.83 2H20v12z"/>
                            </svg>
                            <span class="photo-label">Foto 3</span>
                            <span class="photo-hint">Toque para capturar</span>
                        </div>
                        <div class="photo-preview-container">
                            <img class="photo-preview" id="preview3" alt="Preview foto 3">
                            <button type="button" class="photo-remove" aria-label="Eliminar foto">×</button>
                            <div class="photo-timestamp" id="timestamp3"></div>
                        </div>
                    </div>
                </div>

                <!-- Foto del Ticket -->
                <div class="ticket-section">
                    <h3 class="subsection-title">Ticket</h3>
                    <div class="photo-upload-container photo-upload-ticket" data-photo-id="ticket">
                        <div class="photo-placeholder">
                            <svg class="ticket-icon" viewBox="0 0 24 24">
                                <path d="M20 12v-1.707c0-.4-.159-.784-.44-1.06l-1.06-1.06a3 3 0 1 1 0-4.243l1.06-1.06c.281-.281.44-.66.44-1.06V2a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v.793c0 .4.159.784.44 1.06l1.06 1.06a3 3 0 0 1 0 4.243l-1.06 1.06c-.281.281-.44.66-.44 1.06V12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2zM14 6h-4v2h4V6zm0 4h-4v2h4v-2z"/>
                            </svg>
                            <span class="photo-label">Capturar Ticket</span>
                            <span class="photo-hint">Toque para tomar foto</span>
                        </div>
                        <div class="photo-preview-container">
                            <img class="photo-preview" id="previewTicket" alt="Preview ticket">
                            <button type="button" class="photo-remove" aria-label="Eliminar foto">×</button>
                            <div class="photo-timestamp" id="timestampTicket"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Información de Ubicación -->
            <section class="form-section">
                <div class="location-status" id="locationStatus">
                    <svg class="location-icon" viewBox="0 0 24 24">
                        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                    </svg>
                    <div class="location-info">
                        <span class="location-status-text">Obteniendo ubicación...</span>
                        <span class="location-coords" id="locationCoords"></span>
                    </div>
                    <button type="button" class="btn-retry-location" id="retryLocationBtn" style="display: none;">
                        <svg viewBox="0 0 24 24" width="16" height="16">
                            <path fill="currentColor" d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/>
                        </svg>
                        Reintentar
                    </button>
                </div>
            </section>

            <!-- Botón de Envío -->
            <section class="form-section">
                <button type="submit" class="btn btn-primary" id="submitBtn">
                    <span class="btn-text">Enviar Asistencia</span>
                    <span class="btn-loader"></span>
                </button>
            </section>
        </form>

        <!-- Mensajes de Estado -->
        <div class="alert alert-success" id="successMessage">
            <svg class="alert-icon" viewBox="0 0 24 24">
                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
            </svg>
            <div class="alert-content">
                <strong>¡Asistencia Registrada!</strong>
                <p>Su asistencia ha sido enviada correctamente.</p>
            </div>
        </div>

        <div class="alert alert-error" id="errorMessage">
            <svg class="alert-icon" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
            </svg>
            <div class="alert-content">
                <strong>Error al Enviar</strong>
                <p id="errorMessageText">Por favor, intente nuevamente.</p>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/app.js"></script>
</body>
</html>